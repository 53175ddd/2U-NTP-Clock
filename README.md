# 自作 2U NTP 時計

KiCAD 8 にて開発しています．

## 取扱説明書

現在開発中のため，完成次第書きます．

## ファームウェアアップデート方法

> [!NOTE]
> 開発には Arduino 環境を使用しています．手順 0 に従って Arduino IDE をインストールしてください．

> [!NOTE]
> 既にインストール済みの場合は飛ばしてください．

### 手順 0 - 1｜Arduino IDE のインストールと初期設定

以下のリンクより，Arduino IDE のインストーラをダウンロードして，インストールします．

<https://arduino.cc/en/software/>

インストールしたら，[Ctrl] + [,] で基本設定を開き，`Luanguage:` の右のプルダウンメニューを展開して「日本語」を選択し，[OK] を押して日本語化します．  
その真下のチェックボックス 2 つにチェックを入れておくと良いでしょう．  
その後，以下の URL を「追加のボードマネージャの URL:」の欄にコピペします．

```
https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_dev_index.json
```

### 手順 0 - 2｜ESP32 の開発環境のインストール

Arduino IDE のインストールができたら，ESP32 用の開発環境をインストールします．

[Ctrl] + [Shift] + [B] を押してボードマネージャを開き，検索窓に「ESP32」と入力します．  
すると「esp32 by Espressif Systems」がでてくるので，最新版をインストールします．

> [!WARNING]
> 結構時間がかかります．

### 手順 1 - 1｜GitHub リポジトリのクローン

Git コマンドあるいは GitHub Desktop などを用いて GitHub リポジトリをクローンするか，Zip でダウンロードし，任意のディレクトリに展開します．

### 手順 1 - 2｜Arduino スケッチの起動と修正

`./2U-NTP-Clock.ino` を開きます．

以下のような記述があるので，それをお使いの環境に合わせて変更します．

```cpp
/* Wi-Fi アクセスポイントの設定 */
/* "" の中身を変更してください． */

char ssid[] = "YOUR-SSID-HERE";
char psk[]  = "YOUR-PSK-HERE";
```

### 手順 1 - 3｜PC に接続

USB Type-C ケーブルで コントローラ（M5 Stamp-S3）と PC を接続します．

### 手順 1 - 4｜ビルドと書き込み

ボード選択画面から「M5StampS3」を選択し，COM ポートも選択します．

[Ctrl] + [U] でビルド & フラッシュします．

### 手順 2 - 1｜動作確認

ファームウェアを書き込むと自動的に再起動します．  
再起動後，正しく時刻同期ができるかを確認してください．
